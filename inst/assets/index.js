!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("Shiny")):"function"==typeof define&&define.amd?define(["Shiny"],t):"object"==typeof exports?exports.communicate=t(require("Shiny")):e.communicate=t(e.Shiny)}(self,(__WEBPACK_EXTERNAL_MODULE__230__=>(()=>{"use strict";var __webpack_modules__={230:e=>{e.exports=__WEBPACK_EXTERNAL_MODULE__230__}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](r,r.exports,__webpack_require__),r.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};return(()=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{com:()=>com,getCom:()=>getCom,getComs:()=>getComs,hasCom:()=>hasCom});var shiny__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(230),shiny__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(shiny__WEBPACK_IMPORTED_MODULE_0__),__awaiter=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{_(n.next(e))}catch(e){i(e)}}function c(e){try{_(n.throw(e))}catch(e){i(e)}}function _(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,c)}_((n=n.apply(e,t||[])).next())}))},__generator=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(_){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,n=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,_])}}},endpoints={},timeouts={},types=[];function com(e,t){return __awaiter(this,void 0,void 0,(function(){var r,n;return __generator(this,(function(o){switch(o.label){case 0:if(!e)throw new Error("No id provided");if(!hasCom(e))throw new Error("No com found for ".concat(e));if(t||(t={}),0===Object.keys(endpoints).length)throw new Error("No coms registered, did you forget to registers channels with `com()`");return r=makeQuery(e,t),[4,fetch("".concat(endpoints[e].path,"&").concat(r))];case 1:return[4,o.sent().json()];case 2:if((n=o.sent()).error)throw new Error(n.error);return[2,n]}}))}))}function getComs(){var e=[];for(var t in endpoints){var r={id:endpoints[t].id,path:endpoints[t].path,args:endpoints[t].args};e.push(r)}return e}function getCom(e){if(!e)throw new Error("No id provided");if(!hasCom(e))throw new Error("No com found for ".concat(e));return getComs().filter((function(t){return t.id===e}))[0]}function hasCom(e){if(!e)throw new Error("No id provided");return getComs().some((function(t){return t.id===e}))}function makeQuery(e,t){if(!e)throw new Error("No id provided");if(!t)throw new Error("No args provided");var r=endpoints[e].args;return Object.keys(t).map((function(e){var n=t[e],o=r.find((function(t){return t.name===e}));if(!o)throw new Error("Invalid argument: ".concat(e,", not handled by R function"));if(!typeMatch(n,o))throw new Error("Invalid argument: ".concat(e,", type mismatch, expected ").concat(o.type,", got ").concat(typeof n));return n=convertArg(n),"".concat(e,"=").concat(encodeURIComponent(n))})).join("&")}function isDate(e){return e instanceof Date}function convertArg(e){return isDate(e)||"object"==typeof e&&(e=JSON.stringify(e)),e}window.Shiny.addCustomMessageHandler("communicate-set-path",(function(e){endpoints[e.id]=e,e.types&&(types=e.types);var t=new CustomEvent("communicate:registered",{detail:getCom(e.id)||{}});clearTimeout(timeouts[e.id]),timeouts[e.id]=setTimeout((function(){document.dispatchEvent(t)}),250)}));var RESERVED_TYPE=["character","integer","numeric","date","posix","dateframe","list","function"];function typeMatch(value,valid){if(!valid.type)return!0;if(!RESERVED_TYPE.includes(valid.type)){var checker=types.find((function(e){return e.type===valid.type}));if(!checker.js_checker)return!0;var fn=eval(checker.js_checker),result=fn(value);return"boolean"==typeof result?result:(console.error("custom type checker must return a boolean value"),!1)}return!(!isDate(value)||"date"!==valid.type)||!(!isDate(value)||"posix"!==valid.type)||"object"==typeof value&&"dataframe"===valid.type||"object"==typeof value&&"list"===valid.type||"number"==typeof value&&"numeric"===valid.type||"number"==typeof value&&"integer"===valid.type||"string"==typeof value&&"character"===valid.type}})(),__webpack_exports__})()));